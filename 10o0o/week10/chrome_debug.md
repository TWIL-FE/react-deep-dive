# 크롬 개발자 도구를 활용한 분석

## 크롬 개발자 도구란?

- 크롬 브라우저에서 제공하며, 웹페이지 내의 구성 요소 혹은 상호작용하는 일들을 보여주는 개발 도구
- Ctrl + Shift + i로 열 수 있음
- Ctrl + Shift + c로 요소 확인 가능(focus)

## 요소 탭

- HTML, CSS등 정보 확인 가능
- 특정 요소에 접근해서, 계산됨 부분에서 어떤 class로 인해 어떤 속성이 적용되었는지 확인 가능
- 스타일을 요소탭에서 수정 가능하며, 수정 시 반영이 된다. (일시적 반영)
- 디버깅하고 싶은 요소를 선택해 중단 위치를 설정하면, 해당 요소에 관한 작업이 일어날 때마다 브라우저가 렌더링을 중단하고, 변경을 일으킨 소스 코드를 보여준다.
- 특정 요소의 일시적 삭제, 복사(html, json 등)을 지원해준다
- 이벤트 리스너 텝에서, 어떤 이벤트 리스너가 요소에 부착되어 있는지 ㅘㄱ인 가능ㅎ다ㅏ
- 속성등 기타 요소의 attribute 확인이 가능하다

## 소스 탭

- 해당 웹을 불러오기 위해 실행하거나 참조된 모든 파일 확인 가능
- JS, Html, CSS, Font
- 마찬가지로 중단점을 생성해 디버깅이 가능하다.

## 네트워크 탭

- HTTP, WS 요청 등, 모든 통신하는 정보 확인이 가능하다
- 통신 종류를 예를들어 Fetch/XHR, JS등의 텝들로 분류하여 볼 수 있다.
- waterfall을 통해, 어떤 요청이 오래 걸리고, block되는지 볼 수 있다.
- 요청 시, 요청 헤더, 응답 헤더, 요청 바디, 응답 바디 등을 상세하게 볼 수 있다.
- 소스코드에서 요청시 가져올수 없는 헤더들을 쉽게 조회가능하다. (ex, Content-Disposition 등...)
- 요청 리소스 크기와, 요청시 걸린 시간 등이 시각적으로 확인 가능하여 디버깅 하기 수월하다

## 메모리 텝

### 힙 스냅샷

- 현재 메모리 상황을 스냅샷에 저장하여, 현재 시점의 메모리 상황을 저장할 수 있다.

### 타임라인의 할당 계측

- 현재 시점의 메모리 상황이 아닌, 시간의 흐름에 따른 변화를 알려준다.
- 주로 로딩이 되는 과정의 메모리 변화, 상호작용을 했을 때 메모리 변화 등을 측정할때 쓰인다.

### 할당 샘플링

- 메모리 공간을 차지하는 자바스크립트 함수를 볼수있다.

### 자바스크립트 인스턴스 VM 선택

- 가상머신 인스턴스를 선택하여 해당 환경에서 실제 해당 페이지가 자바스크립트 힙을 얼마나 점유하는지 나타내준다.
- 해당 힙 점유율 크기는 JS실행(상호작용)에 따라 실시간으로 바뀐다.
- Chrome은 64비트에서 4GB, 32비트에서 1GB까지 할당 가능하므로, 최대 1GB가 넘지 않도록 힙을 유지하는 것이 좋다

## Nextjs 디버깅하기

### vscode에서 디버깅하기


```json
// .vscode/launsh.json

{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Next.js: debug server-side",
      "type": "node-terminal",
      "request": "launch",
      "command": "npm run dev"
    },
    {
      "name": "Next.js: debug client-side",
      "type": "chrome",
      "request": "launch",
      "url": "http://localhost:3000"
    },
    {
      "name": "Next.js: debug full stack",
      "type": "node-terminal",
      "request": "launch",
      "command": "npm run dev",
      "serverReadyAction": {
        "pattern": "- Local:.+(https?://.+)",
        "uriFormat": "%s",
        "action": "debugWithChrome"
      }
    }
  ]
}
```
- F5를 눌러 디버깅 세션을 시작할수있다

### chrome 통해 디버깅 하기

- next를 다음과 같이 시작한다
```
NODE_OPTIONS='--inspect' next dev
```
- 그 후, chrome://inspect로 이동한다.
- 앞선 설명과 마찬가지로, 디버깅 할 준비가 끝나있다.

## ab를 사용한 임의적 트래픽 생성 테스트

```
ab -k -c 50 -n 10000 "http://127.0.0.1:3000/"
```
- 위의 명령어는 3000포트로 50개의 요청을 총 10000회 시도한다.
- 해당 명령어를 실행 후, 요청으로부터 응답받는데 걸린 시간, 바이트 크기 등 다양한 정보를 확인 가능하다